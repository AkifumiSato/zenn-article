---
title: "コンポーネント指向"
---

## 要約

Reactは**コンポーネント指向**なフレームワークであり、Webをページ単位ではなくコンポーネント単位で考えることができます。コンポーネント指向では、**再利用性**と**関心の分離**の観点が特に重要です。

## 背景

Webは当初、ドキュメントの参照を目的に発展した技術です。そのため、Webの基本的なアーキテクチャはURLに対応するページを取得する、いわば**ページ指向**です。URLに対応する1つのHTMLファイルがあり、装飾するCSS、動的振る舞いを定義するJavaScriptのように、ページを中心としたアーキテクチャが基本となっています。

当初のドキュメント参照用途でのWebは非常にシンプルなものだったので、このアーキテクチャでも十分でした。しかし、Web技術の発展とアプリケーション需要の拡大により、開発者に対する要求は複雑化し、ページ単位でCSSやJSを考えなければならないことは大きなデメリットとなりました。

### ページ指向からコンポーネント指向へ

**コンポーネント指向**は、UI部品を組み合わせてページを構成するような設計思想です。これにより、常にページ単位のスコープで考えなければならなかったCSSやJavaScriptの実装を、コンポーネント単位で考えることができます。コンポーネントは複数のページで共通利用できるので、再利用性も向上します。

## 設計・プラクティス

Reactは**コンポーネント指向なフレームワーク**です。コンポーネントを組み合わせてアプリケーションを構築します。

Reactコンポーネントは[_JSX_](./part_1_jsx)や*CSS modules*/*CSS in JS*などの技術によって、全てJavaScriptとして扱うことが一般的です。

```jsx
import styles from "./my-button.module.css";

function MyButton({ children, onClick, variant }) {
  const buttonClass = `${styles.button} ${variant ? styles[variant] : ""}`;

  return (
    <button className={buttonClass} onClick={onClick}>
      {children}
    </button>
  );
}
```

コンポーネント指向の説明では、コンポーネントを「UI部品」と表現しましたが、ReactにおけるコンポーネントはJavaScript関数（もしくはClass）そのものであり、見た目を伴わない振る舞いのみを持ったコンポーネントも存在します。Reactにおけるコンポーネントは「UI部品」というより「部品」そのものだと考えるとわかりやすいかもしれません。

当然ながら、どの粒度でコンポーネントを定義するか、どう責務を設計するかは非常に重要です。Reactには様々なデザインパターンが存在しますが、筆者が考える最も基本的なコンポーネント設計の観点は、**再利用性の向上**と**関心の分離**です。

### コンポーネントと再利用性

複数個所で利用するUI単位は、コンポーネントとして定義すべきです。デザインシステムで一般的に提供されるような低レベルなコンポーネント^[参考: [MUIのComponents](https://mui.com/components/)]はもちろんのこと、複数箇所で使う大きなUI単位もコンポーネントとして定義することで、重複実装を排除することができます。

ただし、複数箇所で利用する場合に個別の都合が入り続けると、責務が肥大化し破綻します。共通利用する単位でのコンポーネント分割、特に大きなコンポーネントは慎重に設計する必要があるでしょう。

### コンポーネントと関心の分離

Reactではページ^[フレームワーク利用を前提とています]や振る舞いもコンポーネントとして表現します。そのため、**関心の分離**を目的にコンポーネントを分割することがあります。

適切にコンポーネントを分割しなければ、重厚なコンポーネントが誕生し保守性や可読性に甚大な影響が出ます。一方、過剰な分割は保守性や可読性を悪化させうるため、適切な粒度での分割が重要です。「適切な粒度」は、アプリケーション特性や開発者特性にもよるため、一概な解はありません。そのため、開発者間での合意形成が重要です。

### コンポーネント単位とレンダリングの最適化

再利用性の向上と関心の分離以外にも、**レンダリングの最適化**を目的にコンポーネントを分割することがあります。Reactは状態の変化に応じてコンポーネントを再レンダリングしますが、ページ全体を再レンダリングするわけではありません。状態が変化したコンポーネントとその配下のコンポーネントのみを際レンダリングします。これは言い換えると、コンポーネントを適切に分割することで再レンダリングを最適化できることを意味します。

## トレードオフ

### デザイナーの考えるコンポーネント

デザイナーにとってコンポーネントとは**UIコンポーネント**を指すことが多く、システム的振る舞いを持たない場合も多いので用語の取り扱いには注意が必要です。

Reactにおいては、ページコンポーネントのように非常に大きなコンポーネントや、システム的振る舞いのみを定義したContainerコンポーネントなど、デザイン文脈では登場しないコンポーネントも多数存在します。

### 学習コスト

TBW

- コンポーネント指向は既存のWebアーキテクチャの上に成り立つものであり、HTML・CSS・JSの学習ありきで理解できるものである
- そのため、初学者の学習コストとしては少し高くなる可能性もある
- 一方で、初学者が無設計にWebアプリケーションの構築に挑んで失敗するような事態は避けられるので、トレードオフである

### コンポーネント間のやりとり

TBW
