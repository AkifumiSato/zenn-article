---
title: "PPRはアイランドアーキテクチャなのか"
emoji: "🏝️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["nextjs", "react"]
published: false
---

- 先日書いたPPRの記事でアイランドアーキテクチャみたいなものかという感想を見かけた
- 社内で話した時も「何が違うのか」という質問をもらった
- 結論から言うと、PPRとアイランドアーキテクチャは全く異なるものである
- 本稿では、PPRとアイランドアーキテクチャの違いについて解説する

## PPR

- PPR(Partial Pre-Rendering)の紹介
- PPRは画面を基本静的レンダリング(build時レンダリング)にしつつ、一部を動的レンダリング(リクエストごとにレンダリング)にする

## アイランドアーキテクチャ

- preactの作者が提唱し、astroなどで採用されてるアーキテクチャ
- 画面を静的な部分とインタラクティブな部分に分けて、それぞれが独立してハイドレーションするような仕組み

## PPRとアイランドアーキテクチャの違い

- PPRとアイランドアーキテクチャはどちらも「静的な部分と動的な部分を分ける」という表現からして似ているようにも見える
- しかし、PPRはサーバー側でのレンダリングについて話しており、アイランドアーキテクチャではクライアントサイドのレンダリングについて話している
- つまり同じく「静的」と表現してても、これらは「何が静的か」という点で全く別な意味である
- PPRの場合データが静的かどうかが主眼、アイランドアーキテクチャではJSが不要な部分を指して静的と表現している

### Client Componentsとislandの比較

- Next.jsで言うならば、Client Componentsの方がアイランドアーキテクチャで言うインタラクティブ（動的）である
- islandと異なりそれをネストすることもできたりする
- islandの方がJSサイズは少ないなどあるかもしれない(未調査)
- Client Componentsとアイランドアーキテクチャの類似についてはDan氏も言及してる
- https://x.com/dan_abramov2/status/1757986886390264291
- PHP+jQueryも含め、これらのアーキテクチャはインタラクティブ・非インタラクティブな2層のレイヤーに分けられる点で古くからあるアイディアである

## まとめ

- PPRは後発(しかも開発中)の新たな概念であり、優れていると筆者は考える
- 一概にNext.jsの方が優ってるなどと言うつもりはない
- そもそも筆者はAstroにあまり詳しくないし、技術の良し悪しは作りたいもの・成し遂げたいことを含む多角的な視点を必要とするので、ケースバイケースだと考えてる
- 「PPRとアイランドアーキテクチャは全く異なるものである」「PPRはまだ新しい概念で、提唱元のNext.jsでさえ開発中の段階」ということだけは理解してもらえると嬉しい
