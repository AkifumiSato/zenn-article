---
title: "ZennでRustの記事を書いたら本を書くことになった話"
emoji: "⛳"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["rust"]
published: false
---

最近本を出版しました。「Webアプリ開発で学ぶ Rust言語入門」という本です。

https://www.shuwasystem.co.jp/book/9784798067315.html

タイトルの通り、Webアプリ開発を通じてRustを学ぼうという本です。筆者はRust界隈で名が通ってるわけでも、過去に執筆系経験があるわけでもありません。そんな筆者がこの本を書くことになったのは、Zennの記事がきっかけでした。

本稿は本を書くきっかけをくれたZennへの感謝を込めて、執筆体験について紹介する記事です。

## 書くことになった背景

### 「Typescriptの次はRustかもしれない」

2年ほど前、こんな記事を書きました。

https://zenn.dev/akfm/articles/81713d4c1275ac64a75c

普段はTypescriptばかり書いてた筆者が、Rustを学ぶのが楽しくて書いた記事でした。正直、RustがTypescriptを置き換えるとは当時も今もあまり思ってないです(こんなこと書いていいのだろうか)。が、一方で、Typescriptユーザーの第二言語としては面白いのではないかとも感じてたし、部分的に置き換えていく可能性は感じていました。そんな妄想をしながら書いた記事だったし、初めてZennで書いた記事だったのですが想像以上に反響がありました。否定的な意見もいただいたし、一方で「面白かった」「Rust学んでみたくなった」「Rust面白そう」などの声もありRust楽しいって気持ちが伝わったならよかったなと思い、その後もZennで記事を書くモチベーションになりました。

### 出版社からの連絡

上記の記事を書いてから1年ほど経った頃、筆者の元へ出版社の編集者の方(以下担当編集)から相談のメールが来ました。相談内容としては以下のようなものでした。

- Rustの注目度が上がってるように思える
- 入門書はいくつか存在するが、よりライトに読める超入門書を考えてる
- 果たして需要はあるのだろうか
- この企画を営業や経営陣にどう説明するか

この相談を受けた頃、筆者も「Rust難しそう」という声は実際に聞いたこともあったし、Rustについての話題は時折出るけど実際に学んでいる人はまだまだ少ない印象でした。一方で[Deno](https://deno.land/)や[Rome](https://rome.tools/)など、方々でのRust採用が引き続き目立っていましたし、Rustの注目度は決して低くないという印象でした。RustのWeb開発でみてもRustの非同期ランタイムの`tokio`開発チームが作ったWebフレームワーク[axum](https://github.com/tokio-rs/axum)の登場やSQLライブラリ[sqlx](https://github.com/launchbadge/sqlx)の台頭など、どんどん新しいものも出てきて決して盛り下がってる印象はありませんでした。

そういった筆者の私見をもとに何度か相談に対し回答・やりとりするうちに、徐々に本の企画を手伝うような流れになっていきました。

## 企画

当時の筆者の仮説は以下です。

- Rustに興味はあるがまだ学んでいない層はそれなりにいる
  - これらの潜在層にはWeb開発者も多く含まれている
  - Web開発者にとって、現存する入門書はシステムプログラミングよりなものやリッチなものが多く、ハードルが高い
  - Web開発者にとって、Web開発を通じてRustに入門するのは普段の業務に近くよりライトに学べるのではないか

これらの仮説をもとに、Web開発を通じて学ぶRust入門書はどうかと担当編集に提案しました。

ここで混在させてはいけない重要なテーマとして、「RustはWeb開発に向いてる」と主張したいわけではなく、「Web開発者がRustを学ぶならWeb開発でやるのがいいじゃないか」という本だということです。筆者としてはもちろん、RustでやるWeb開発(というかAPI開発)は楽しいし、もっと盛り上がって欲しいなと思っています。一方で、Web開発でどの言語を使うか・どういう言語が流行っていくかは予測が非常に難しいと思っていますし、正直予測してもしょうがないとも思っています。なので、ここを誤解されないように本の構成を検討する必要がありました。

これを担当編集、さらにはその先の出版社の営業担当の方々や経営陣に理解してもらうのが結構大変でした。当然担当編集はある程度技術的知識を持っていてもエンジニアではないので、この辺の微妙なテーマの違いを理解し、その上でRustをWeb開発で学んでもらうメリットも理解してもらうというのは高い説明難易度を伴いました。

ともあれ粘り強く付き合ってくれた担当編集のおかげで企画が形を成してきて、その流れで執筆も自分が担当させていただくことになりました。あとは無事企画が通るのを待つのみ...ではなく、「どういったマーケットで」「どういったターゲットで」「これまでの入門書との違いは何で」「書店様にはどう説明すべきか」など、企画が通るまでに必要だった説明資料の作成など、タスクは多岐に渡り、これらのタスクや課題を1つづつクリアしてなんとか企画が無事通りました。

## 出産・育児

ここで急にプライベートな話に飛びますが、企画が通った頃ちょうど第一子の出産時期が近い頃でした。そもそも執筆の依頼がきた時に、チャンスだと思った一方で第一子の出産時期を考えるとどう考えても被るので受けるかどうかかなり悩みました。

妻は元々エンジニアでしたし、今も同じ業界にいるのでかなり理解がある方でしたが、やはり不安だったと思います。ですが相談したところ、かなり後押ししてくれました。この時何色を示されてたら受けれなかったと思います。妻には本当に感謝です。

それでも執筆開始時期が完全に出産予定期に被ったのは流石に無理だと思い、担当編集に相談して開始は出産から3ヶ月ほど経った頃から開始とさせていただきました。正直どの時期がどのくらい大変かは全く予想できなかったし、書き始めた頃は子育て・仕事・執筆で毎日全く余裕のない日々でした。本を書く以上にともかく子育てが大変で、その中で時間を見つけては本を書かなきゃいけないプレッシャーもありストレスは相乗効果でより高かった時期でした。

余談ですが、本当に大変だったけど子供は本当かわいいです。Rustより好きです。

## 実装・執筆

閑話休題、ここで執筆全体の流れを見てみます。

1. 2021/09: 相談を受ける
1. 2021/10 - 2021/12: 企画(1)
1. 2022/12 - 2022/03: 出産・子育て初期
1. 2022/03: 企画(2)
1. 2022/03: 企画が通る
1. 2022/07中: 脱稿
1. 2022/07末 - 9中: 校正
1. 2022/09末: 発売

脱稿は当初6末予定だったのですが、書いてるうちにどうしても間に合わず2週間ほど予定をずらさせていただきました。実は企画が通る前から少し書いてたのですが、それでもどうしても執筆・子育て・仕事の3つを成り立たせ続けるのは至難の業で、結果遅れてしまいました。

企画後、実際の執筆の流れもみてみましょう。

### 1. 調査・構成の検討

企画時点である程度方針や構成概要は検討済みでしたが、一番はWebアプリ開発を通じてRustを学ぶ本なので「何をどこまでどうやって作るか」を検討しました。

- Rustの文法についてはどこまで解説するのか、マルチスレッドやメモリ周りに触れすぎると読者は離れてしまわないか
- RustのWebフレームワークはいくつもあり、どれを使うのか
- SQL周りのライブラリは何を使うのか
- フロントエンドはどうするのか、多くはテンプレートエンジンを使うが昨今のフロントエンドからするとAPI開発に終始した方がいいのではないか(その場合、ReactとVueどちらにするか)

これらを自分に問い、一つづつ自分なりの仮説と解を持って構成の検討を進めました。

### 2. 執筆環境の構築

構成がある程度固まったら早速執筆...ではなく、執筆環境の構築を行いました。当初は[vivliostyle](https://vivliostyle.org/ja/)を利用していましたが、途中からシンプルにマークダウンの表示だけ見たくなって[mdbook](https://blog1.mammb.com/entry/2019/12/31/000000)を利用しました。`mdbook`は早いし使い勝手も良くて、何よりRust製なので(？)とてもよかったです。

あとは各ページ・各章・全章の文字数を算出して記録するコミットフック環境を作成しました。これらは[simple-git-hooks](https://github.com/toplenboren/simple-git-hooks)と普通にNode.jsで文字数カウントを`count.log`に出力するよう実装しました。

:::details count.log
all string length: 237498
chapter_1 9802
chapter_2 45950
chapter_3 53506
chapter_4 33529
chapter_5 34159
chapter_6 60552
manuscripts/chapter_1/1.md 2993
manuscripts/chapter_1/2.md 6715
manuscripts/chapter_1/index.md 94
manuscripts/chapter_2/1.md 6017
manuscripts/chapter_2/2.md 8125
manuscripts/chapter_2/3.md 3548
manuscripts/chapter_2/4.md 8470
manuscripts/chapter_2/5.md 9507
manuscripts/chapter_2/6.md 1856
manuscripts/chapter_2/7.md 2125
manuscripts/chapter_2/8.md 2915
manuscripts/chapter_2/9.md 3288
manuscripts/chapter_2/index.md 99
manuscripts/chapter_3/1.md 1564
manuscripts/chapter_3/2.md 8615
manuscripts/chapter_3/3.md 7239
manuscripts/chapter_3/4.md 18338
manuscripts/chapter_3/5.md 10089
manuscripts/chapter_3/6.md 7400
manuscripts/chapter_3/index.md 261
manuscripts/chapter_4/1.md 5515
manuscripts/chapter_4/2.md 3970
manuscripts/chapter_4/3.md 11775
manuscripts/chapter_4/4.md 7807
manuscripts/chapter_4/5.md 4178
manuscripts/chapter_4/index.md 284
manuscripts/chapter_5/1.md 2017
manuscripts/chapter_5/2.md 5903
manuscripts/chapter_5/3.md 10943
manuscripts/chapter_5/4.md 6020
manuscripts/chapter_5/5.md 9081
manuscripts/chapter_5/index.md 195
manuscripts/chapter_6/1.md 13942
manuscripts/chapter_6/2.md 26148
manuscripts/chapter_6/3.md 20061
manuscripts/chapter_6/4.md 225
manuscripts/chapter_6/index.md 176
:::

これらは本当に作っといてよかったです。というのも、実際のページ数は脱稿後にしかわからないので、おおよその文字数目標を決めて書いていたので、進捗や調整がかなりしやすかったです。

### 3. 実装と執筆のループ

本の構成と環境が整ったので、あとは実際に実装・執筆のループの繰り返しです。途中で何度も構成を見直したり変更したりもしましたが、基本はただひたすらに実装と執筆です。特に大変だったのは、基礎文法とフロントエンド周りです。

基礎文法は言語の根幹をなすところのため、誤った情報を書くわけにはいきません。フレームワークのように必ずしもドキュメントがあるわけでもなく、なんならバージョンによる変更なども加味して歴史的背景や意味論に言及することもあるので解説難易度は高かったです。Rustでは`;`がつくことで式を文にすることができるのですが、結果これを確かめるためにAST Explorerで確認しました。どこで調べても公式に近いところで言及してる記事がなかったのです。たった一文ですが、一度出版するとZennのように修正というわけには行かないので、この辺はかなり時間を使って調べながら執筆しました。

またフロントエンド周りは読者がフロントエンド経験者とは限らないので、ライブラリを多用しないこと・深いところまで言及しすぎないこと・UIライブラリに乗っかってCSSを極力書かないようにするなどしつつ、それでいて初心者でも理解しやすいようにシンプルな仕様と設計を心がける必要があり、かなり工夫が必要でした。普段使っている`Next.js`/`Recoil`/`react-hook-form`など全て封印したので、これもまた大変でした。

ちなみに、実は当初書こうと思ってた内容から実際の執筆途中で何度か大幅な軌道修正をしました。途中まではフロント苦手な人もいるだろうと思いVueで書いてました。Rust学んでると方向性が近いのはReactと思い直して変更してます。APIもログイン実装を削除するなど、かなり大幅な軌道変更をしています。元々のコンセプトの1つである、「超入門書」を目指す上でページ数は企画段階で提示されたものを大幅に超えてはならず、実際に書いてみたらこれらを入れると100ページ以上超えそうだったので断腸の思いで諦めました。

### 4. 見直し





## memo

- 実装・執筆
  - 破棄した案
    - Vueでの実装
    - ログイン機能
    - マークダウン解析
- 校正
  - 初稿
    - 認識合わせが大変だった
    - ページ数の関係で一部内容を削った
      - わかりづらくなった気がして葛藤した
  - 2校
    - 何度も読み直して辛い時期
      - 企画の根本から疑い直したくなってしまった
      - 需要はあるのか？
  - 3校
    - 今更需要を疑いたくなる暗黒期
- 出版後の感想
  - 知人・会社の先輩方など多くの人が宣伝してくれた
    - そのおかげで反響結構あった
    - ポジティブな意見もあった
    - ひとまず、頑張って書いてよかったなと一息つけた
  - Zennで記事を書く意味
    - わからん
    - けどいろいろいいことはある
    - 思ったより反響ないこと、思ったより反響あることなどいっぱいだけど、とりあえずZennはいいサービスだしありがたいチャンスをもらえるきっかけをくれたので感謝
