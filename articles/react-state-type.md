---
title: "ReactのState分類とライフタイム"
emoji: "⌚️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["react"]
published: false
---

ReactはじめSPAのStateは大きく2種類、Local State・Global Stateの2種類でおおよそのStateの分類が可能であると考えていました。これに対し会社の先輩から「実際にはアプリケーションにはServer Stateもあるよね」「スコープだけでなく、時間的グローバルなStateもあるよね」という意見をもらい、非常に納得しました。なんとなくで実装してしまってたのでこの3種類のStateの分類を整理し、さらにこの値の生存期間をRustから言葉を借りてStateの**ライフタイム**と呼称し、ライフタイム別にStateを再分類しState戦略について自分なりに考察したいと思います。

Reactで何かしらのStateを実装する時に、本稿の分類が実装の参考になれば幸いです。

:::message
Rustのライフタイムはコンパイラによってチェックされる機能名を兼ねていますが、ここではスコープとは別の分類軸のための概念として表記しています。
:::



- 序文
  - ReactのStateは大きく2種類だと思ってた＋なんとなくでやってしまってた
  - 実際にはもっと分解できる
    - データタイプによる分類 -> どう実装すべきか
    - ライフタイムによる分類 -> 状態をどこに保存すべきか
  - これらを意識することでどう実装するかが結構変わる。参考になれば
- データタイプによる分類
  - 従来の2種類
  - 3種類目、サーバーState
  - ライブラリの選択肢
- ライフタイムによる分類
  - ライフタイムがなぜ重要か
    - 状態をどこに保存すべきかは実は結構悩ましい
    - また、保存する処理をどう実装するかも結構悩ましい
  - ライフタイム別
    - unmout
    - memory
    - history
    - storage
    - server
  - 判断軸
    - その機能のライフタイムを見誤らないようにすると体験が自然
    - unmoutまでなコンポーネントって実はそんなにない？
  - Historyに紐づくState管理はNextはしづらい
    - scroll amnesia
    - PR出してるけどなかなかマージされない、応援して

