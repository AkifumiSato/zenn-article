---
title: "Metaに学ぶ、大規模開発のデータフェッチ設計と最適化"
emoji: "🧠"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["react", "rsc"]
published: true
---

Reactでは、**バケツリレー**(Props Drilling)と呼ばれるアンチパターンが存在します。これは、上位のコンポーネントでデータフェッチを行い、実際にそのデータを利用する末端のコンポーネントまでデータをPropsで渡し続けることを指します。

```
// e.g. ユーザーのカート情報をバケツリレーするイメージ
<Page> -> <Layout> -> <Header> -> <Cart>
```

バケツリレーはデータに依存するコンポーネントが多くなるため、コードの可読性や変更容易性が低下します。

このように、データフェッチの設計はスケーラビリティ^[本稿では、アプリケーションの多機能かに伴いコードが肥大化しても複雑性を抑えられることを「スケーラビリティ」と表現しています。]とパフォーマンスに強く影響します。Metaではスケーラビリティとパフォーマンスを両立させるために、非常に優秀な開発者たちが長い期間研究を重ねたナレッジを公開しています。

本稿ではMetaにおけるスケーラビリティとパフォーマンスを両立させるために採用してる、**短期キャッシュ**と**バッチング**について解説します。

## 要約

- Metaでは長年の研究から、大規模開発における設計には自立分散性が重要だと考えている
- データフェッチの最適化は分散思考ではできない、集権思考が必要
- Metaではこの矛盾した価値観を、短期キャッシュとバッチングによって解決してる
- 技術的には、React CacheとDataLoaderによりこれらは容易に実現できる

# 分散思考と集中思考

TBW
