---
title: "react-hook-formとformの設計原則"
emoji: "🎉"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["react"]
published: false
---

- 序文
  - reactにおけるformの実装っていろいろかんがえられますよね
  - どのライブラリで実装するのかもそうだし
  - それに付随して制御・非制御どちらでコンポーネント作っていくのかって話もある
  - react-hook-form(以下RHF)に乗っかればそれなりに楽はできる
  - ただし、form内にモーダルとか出てくると一気に設計悩ましくなってくる
  - 実際実装してて感じてきたformの設計原則を書き残したい
- 基本方針
  - 当たり前だが、1つのライブラリに集約することが望ましい
  - ここではRHFを推したい
  - ただし、RHFだと作りづらいUIというのがある
    - モーダルとかサジェストUIとか
  - 作りづらいUIが出てきたときに、RHF以外で実装しようかなって考えてしまう
  - が、RHFによせておかないと実装者によってぶれたり、末端のコンポーネントが利用者を知り過ぎてたりしてしまう
  - なので、「formの実装はRHFでやる」に統一した方が良い
- ではRHFで作りづらいモーダルはどうするのか
  - これらもformを構成する入力要素として扱うとわかりやすい
  - とはいえ、1つの入力要素として扱うには大きすぎると感じるはず
  - モーダルを開く・選択を表示する要素を1つの入力要素として扱い、モーダルは1つのフォームとして扱おう
  - formはそもそも1つのトランザクションとみなすことができる
  - モーダルも1つのトランザクションプロセスであり、formとして扱える
    - 仕様にもよるが、多くのデザイナーがそう認識しており、モーダル<->ページはよくある変更（個人の経験含む）
    - 「保存しないと閉じれないモーダル」「閉じたら保存しちゃうモーダル」は個人的にはあまり良くない体験な場合がある
      - ↑で違和感ない場合、RHFで実装するのはそうむずかしくないので割愛
  - 実際、モーダルを1つのformとして扱うと、後でページにしたり、逆にページをモーダルにしたりするのに苦労しない
  - ということで、モーダルは1つのformであり、formとformをsetValueで繋げばモーダル<->ページのような変更でも苦労しない
- formの実装では単一責任の原則を意識する
  - 入力要素と保存処理は分けておかないと苦労しがち
- まとめ
  - RHFに集約しよう
  - モーダルは1つのformとして扱い、form<->formをsetValueで繋ごう

todo: サンプル実装
