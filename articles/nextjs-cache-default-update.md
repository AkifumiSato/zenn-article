---
title: "Next.js braking change of cache"
emoji: "ğŸš€"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nextjs", "react"]
published: false
---

Next.js App Routerã¯å··ã§ã¯é›£ã—ã„ã¨è©•ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã€…ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯Reactã®æ–°æ©Ÿèƒ½ã§ã‚ã‚‹Server Componentsã‚’ã¯ã˜ã‚ã¨ã™ã‚‹**Server 1stã¸ã®ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã‚·ãƒ•ãƒˆ**ã‚’å¿…è¦ã¨ã™ã‚‹ã“ã¨ã€ãã—ã¦åˆè¦‹æ®ºã—ãª**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥æŒ™å‹•**ã«èµ·å› ã—ã¦ã„ã‚‹ã¨ç­†è€…ã¯è€ƒãˆã¦ã„ã¾ã™ã€‚

ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã‚·ãƒ•ãƒˆãŒå¿…è¦ã¨ãªã‚‹Server Componentsã‚„Server Actionsãªã©ã®Reactã®æ–°æ©Ÿèƒ½ã«ã¤ã„ã¦ã¯ã€ã‚¨ãƒ©ãƒ¼ã§æŒ‡æ‘˜ãƒ»ä¿®æ­£ã®ãƒ’ãƒ³ãƒˆãŒæç¤ºã•ã‚Œã‚‹ãªã©åˆå­¦è€…ã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚‚ã—ã£ã‹ã‚Šè€ƒæ…®ã—ãŸè¨­è¨ˆãŒãªã•ã‚Œã¦ãŸã‚Šã€å¤šãã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„è¨˜äº‹ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã“ã‚Œã‚‰ã«ã¤ã„ã¦ã¯React hooksãŒç™»å ´ã—ãŸæ™‚ã®ã‚ˆã†ã«ã‚ã¨ã¯æ™‚é–“ã®å•é¡Œãªã®ã‹ãªã¨ã‚‚æ„Ÿã˜ã¦ã„ã¾ã™ã€‚

ä¸€æ–¹ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã¤ã„ã¦ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç©æ¥µçš„ã‹ã¤ä½•å±¤ã«ã‚‚åˆ†ã‘ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹ä¸Šã€ã€Œæ„å›³ã›ãšã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã¦ã‚‹çŠ¶æ…‹ã€ã¯å½“ç„¶ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãšå‹•ä½œã—ã¦ã—ã¾ã†ãŸã‚ã€åˆå­¦è€…ã«ã¨ã£ã¦Next.jsã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ã¤ã¾ã¥ãã‚„ã™ã„ãƒã‚¤ãƒ³ãƒˆã ã¨ç­†è€…ã¯è€ƒãˆã¦ã„ã¾ã™ã€‚ç­†è€…ã¯ç‰¹ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§ã‚ã‚‹[Router Cache](https://nextjs.org/docs/app/building-your-application/caching#router-cache)ã«ç€ç›®ã—ã€ãã®è¤‡é›‘ã•ã‚„å•é¡Œç‚¹ã«ã¤ã„ã¦éå»è¨˜äº‹ã«ã—ãŸã‚Šã—ã¾ã—ãŸã€‚

https://zenn.dev/akfm/articles/next-app-router-client-cache

ä¸Šè¨˜è¨˜äº‹åŸ·ç­†æ™‚ç‚¹ã§ã¯ã€Router Cacheã¯æœ€ä½ã§ã‚‚30sã¯åˆ©ç”¨ã•ã‚Œã¦ã—ã¾ã†ã“ã¨ã‚’ç­†è€…ã¯å•é¡Œè¦–ã—ã¦ã„ãŸã®ã§ã™ãŒã€ãã®å¾Œ[`experimental.staleTime`](https://nextjs.org/docs/app/api-reference/next-config-js/staleTimes)ãŒå°å…¥ã•ã‚Œã¦Router Cacheã®å¯¿å‘½ã‚’è¨­å®šã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã€çŠ¶æ³ã¯å¤§ããæ”¹å–„ã•ã‚Œã¾ã—ãŸã€‚

ãã—ã¦ã“ã“ã«æ¥ã¦ã•ã‚‰ã«ã€v15ã®æ›´æ–°ã§Router Cacheã‚„[Data Cache](https://nextjs.org/docs/app/building-your-application/caching)ã®defaultè¨­å®šãŒå¤‰æ›´ã•ã‚Œã‚‹ã“ã¨ãŒç™ºè¡¨ã•ã‚Œã¾ã—ãŸã€‚æœ¬ç¨¿ã¯v15ã§è¡Œã‚ã‚Œã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‘¨ã‚Šã®ç ´å£Šçš„å¤‰æ›´ã¨ã€ãã®èƒŒæ™¯ã‚„[PPR](https://nextjs.org/docs/app/api-reference/next-config-js/partial-prerendering)ã¨ã®é–¢ä¿‚ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚

## v15ã®ç ´å£Šçš„å¤‰æ›´æ¦‚è¦

Next.jsã‚³ã‚¢ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚‹[Jimmy Laiæ°](https://x.com/feedthejim)ã«ã‚ˆã£ã¦ã€Next.js@15ã§å¤‰æ›´ã•ã‚Œã‚‹å†…å®¹ãŒå…¬è¡¨ã•ã‚Œã¾ã—ãŸã€‚

https://x.com/feedthejim/status/1792969159321723244

> â—† no more fetch caching by default âœ…(fetchã‚’defaultã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã‚’å»ƒæ­¢)
â—† no more client caching by default âœ…(ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§defaultã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã‚’å»ƒæ­¢)
â—† no more static GET routes by default âœ…(é™çš„GET routeã‚’defaultã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã‚’å»ƒæ­¢ )

ã“ã‚Œã«ã‚ˆã‚Šã€**Data Cacheã¨Router CacheãŒdefaultã§ç„¡åŠ¹åŒ–**ã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ãã®ä»–ã€ç ´å£Šçš„å¤‰æ›´ã§ã¯ãªãæ©Ÿèƒ½è¿½åŠ ã¨ã—ã¦ä»¥ä¸‹ã‚‚ç™ºè¡¨ã•ã‚Œã¾ã—ãŸã€‚

https://x.com/feedthejim/status/1792969608489738554

> â—† incremental PPR migration support(ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ãªPPRãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆ)
â—† next/after, our own little version of waitUntil(`next/after`ã®è¿½åŠ )
â—† the experimental React Compiler support(React Compiler(åˆ¥åReact Forget)ã®experimentalã‚µãƒãƒ¼ãƒˆ)

TBW: [SHIP](https://vercel.com/ship)ã§ç™ºè¡¨ã•ã‚ŒãŸå†…å®¹ã‚’åæ˜ 

## ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®šã®ç ´å£Šçš„å¤‰æ›´

### v14ä»¥å‰ã®åˆæœŸå€¤

### v15ä»¥é™ã®åˆæœŸå€¤

## ãªãœã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å¤‰æ›´ã•ã‚ŒãŸã®ã‹

https://x.com/koichik/status/1793086908299653452

## v15ä»¥é™ã§ã®Next.jsã®è¨­è¨ˆæ€æƒ³

https://x.com/koichik/status/1793092931542487535

## æ„Ÿæƒ³
